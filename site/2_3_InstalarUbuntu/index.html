
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Pasos para la instalación y configuración de Odoo usando Ubuntu Server">
      
      
      
        <link rel="canonical" href="https://sergio-apuntes.github.io/sge/2_3_InstalarUbuntu/">
      
      
        <link rel="prev" href="../2_2_InstalarDocker/">
      
      
        <link rel="next" href="../3_1_ArquitecturaOdoo/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>2.3. Instalación en Ubuntu - Apuntes Sistemas de Gestión Empresarial</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#instalar-en-debian-y-ubuntu" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="Apuntes Sistemas de Gestión Empresarial" class="md-header__button md-logo" aria-label="Apuntes Sistemas de Gestión Empresarial" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apuntes Sistemas de Gestión Empresarial
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2.3. Instalación en Ubuntu
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Apuntes Sistemas de Gestión Empresarial" class="md-nav__button md-logo" aria-label="Apuntes Sistemas de Gestión Empresarial" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Apuntes Sistemas de Gestión Empresarial
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 ERP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            1 ERP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción a Odoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_2_IntroduccionERP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2. Introducción a la Gestión Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_3_IT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3. Informática en la Gestión Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_4_ERP_CRM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4. ERP-CRM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_5_ERP_actuales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5. Revisión de ERPs Actuales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_6_ERP_Libres_Privativos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6. ERPs Propietarios vs ERPs de Código Abierto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_7_CRM_Actuales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7. CRM Actual
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1_8_Terminolog%C3%ADa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8. Terminología ERP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 Instalacion de Odoo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            2 Instalacion de Odoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_1_InstalarOdoo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1. Instalación de Odoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2_2_InstalarDocker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2. Instalación con docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    2.3. Instalación en Ubuntu
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2.3. Instalación en Ubuntu
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-la-ruta-de-los-modulos" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración de la ruta de los módulos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#depurar-odoo" class="md-nav__link">
    <span class="md-ellipsis">
      Depurar Odoo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mejorar-la-salida-de-log" class="md-nav__link">
    <span class="md-ellipsis">
      Mejorar la salida de Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opciones-de-log" class="md-nav__link">
    <span class="md-ellipsis">
      Opciones de log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modo-debug" class="md-nav__link">
    <span class="md-ellipsis">
      Modo debug
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poner-en-produccion-en-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      Poner en producción en Ubuntu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#odoo-por-https" class="md-nav__link">
    <span class="md-ellipsis">
      Odoo por HTTPS
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3 Desarrollo con odoo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            3 Desarrollo con odoo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_1_ArquitecturaOdoo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. Arquitectura de Odoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_2_PrimerModulo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. Primer módulo en Odoo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3_3_Modulos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3. Los módulos en Odoo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 Desarrollo de un módulo de gestión de proyectos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            4 Desarrollo de un módulo de gestión de proyectos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_1_EjemploCreacionModeloBasico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1. Creación de un modelo básico, vistas, menús y actions.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_2_EjemploCamposBasicos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2. Campos básicos y relacionales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_3_EjemploCamposComputados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3. Campos básicos computados.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_4_EjemploExcepcionesMensajes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4. Lanzar excepciones y añadir mensajes de log.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_5_EjemploCamposComputadosRelacionales/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5. Campos computados relacionales
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_6_EjemploCamposValoresDefecto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.6. Campos con valores por defecto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_7_EjemploHerencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.7. Herencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_8_EjemploMejorandoVistas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.8. Mejorando vistas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4_9_EjemploDatosDemo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.9. Datos de demostración
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuracion-de-la-ruta-de-los-modulos" class="md-nav__link">
    <span class="md-ellipsis">
      Configuración de la ruta de los módulos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#depurar-odoo" class="md-nav__link">
    <span class="md-ellipsis">
      Depurar Odoo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mejorar-la-salida-de-log" class="md-nav__link">
    <span class="md-ellipsis">
      Mejorar la salida de Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#opciones-de-log" class="md-nav__link">
    <span class="md-ellipsis">
      Opciones de log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modo-debug" class="md-nav__link">
    <span class="md-ellipsis">
      Modo debug
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poner-en-produccion-en-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      Poner en producción en Ubuntu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#odoo-por-https" class="md-nav__link">
    <span class="md-ellipsis">
      Odoo por HTTPS
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="instalar-en-debian-y-ubuntu">Instalar en Debian y Ubuntu</h1>
<p>Antes de nada, hay que preparar un poco el sistema:</p>
<p>En el caso de Ubuntu o Debian, que es el que nos interesa, Odoo proporciona unos repositorios llamados <strong>Nightly</strong>, que pueden ser añadidos al <strong>sources.list</strong> para instalar de manera automática todo. Estos repositorios se actualizan cada noche, por lo que es posible que, con el tiempo, algunas funciones o archivos cambien si actualizamos.</p>
<p>En principio, todo debería funcionar como indican los manuales, pero si necesitamos utilizar utf-8 por el idioma, hay que hacer algunos pasos previos.</p>
<p>Es posible que Debian o Ubuntu no tenga bien configurados los <strong>locales</strong>. Se puede hacer con:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>dpkg-reconfigure<span class="w"> </span>locales
</span></code></pre></div>
<p>Y seleccionar los de es_ES y el de UTF8 por defecto. Es necesario cerrar la sesión y volver a entrar.</p>
<p>Si <code>dpkg-reconfigure</code> no muestra un asistente, puedes hacer:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>locale-gen<span class="w"> </span><span class="s2">&quot;es_ES.UTF-8&quot;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>dpkg-reconfigure<span class="w"> </span>locales
</span></code></pre></div>
<p>Enlace a los repositorios: <a href="https://nightly.odoo.com/">https://nightly.odoo.com/</a></p>
<p>Y como indica el propio manual, se puede hacer todo con estos comandos (el primero si estamos en Debian):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>ca-certificates
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>wget<span class="w"> </span>-O<span class="w"> </span>-<span class="w"> </span>https://nightly.odoo.com/odoo.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span>-o<span class="w"> </span>/usr/share/keyrings/odoo-archive-keyring.gpg
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;deb [signed-by=/usr/share/keyrings/odoo-archive-keyring.gpg] https://nightly.odoo.com/16.0/nightly/deb/ ./&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/odoo.list
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>odoo
</span></code></pre></div>
<p>Estos comandos instalan los certificados que los navegadores o, en este caso, <code>wget</code> necesitan para admitir HTTPS, después descargan la clave, añaden el repositorio e instalan Odoo.</p>
<p>A continuación, hay que ir a la dirección en el navegador:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>http://&lt;ip o url&gt;:8069
</span></code></pre></div>
<p><a href="https://asciinema.org/a/122875">Asciinema. Video del proceso</a>.</p>
<h2 id="configuracion-de-la-ruta-de-los-modulos">Configuración de la ruta de los módulos</h2>
<p>Como la instalación de Odoo crea el usuario <strong>odoo</strong>, que es el que debemos utilizar para el desarrollo, vamos a asignarle una contraseña y le pondremos como shell <code>bash</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>sudo<span class="w"> </span>passwd<span class="w"> </span>odoo
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-s<span class="w"> </span>/bin/bash<span class="w"> </span>odoo
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A partir de este momento, todos los comandos deben ejecutarse con el usuario <em>odoo</em>.
 O nos logeamos como usuario <em>odoo</em> o mejor hacemos <code>su odoo</code></p>
</div>
<p>La configuración del servidor Odoo tiene una opción llamada <strong>addons-path</strong>. Podemos añadir más rutas para nuestros addons personalizados. Se puede dejar de forma definitiva en el archivo de configuración o iniciar el servidor indicando la ruta de los addons:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>odoo<span class="w"> </span>-d<span class="w"> </span>demodb<span class="w"> </span>--addons-path<span class="o">=</span><span class="s2">&quot;&lt;ruta&gt;&quot;</span>
</span></code></pre></div>
<p>Si queremos que quede guardado de forma definitiva, hay que añadir <strong>--save</strong> al comando. Los comandos serían, por tanto:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>mkdir<span class="w"> </span>/var/lib/odoo/modules
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>odoo<span class="w"> </span>scaffold<span class="w"> </span>pruebas<span class="w"> </span>/var/lib/odoo/modules
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>odoo<span class="w"> </span>--addons-path<span class="o">=</span><span class="s2">&quot;/var/lib/odoo/modules,/usr/lib/python3/dist-packages/odoo/addons&quot;</span><span class="w"> </span>--save
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>La opción --save guarda la configuración en <code>$HOME/.odoorc</code>, que es un archivo para el usuario odoo. Si queremos que sea para todos los usuarios que puedan ejecutar el servidor odoo, se puede poner en el archivo de <code>/etc/odoo</code>.</p>
</div>
<h2 id="depurar-odoo">Depurar Odoo</h2>
<p>Para crear módulos o ver los problemas que están ocurriendo, es necesario leer los archivos de log, pero existe una manera más eficiente de hacerlo. Si observamos el comando que realmente está ejecutando Odoo:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>python3<span class="w"> </span>/usr/bin/odoo<span class="w"> </span>--config<span class="w"> </span>/etc/odoo/odoo.conf<span class="w"> </span>--logfile<span class="w"> </span>/var/log/odoo/odoo-server.log
</span></code></pre></div>
<p>Podemos ver que la opción <code>--logfile</code> envía la salida a un archivo. Si detenemos el servicio con:</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>systemctl<span class="w"> </span>stop<span class="w"> </span>odoo
</span></code></pre></div>
o
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>/etc/init.d/odoo<span class="w"> </span>stop
</span></code></pre></div></p>
<p>Podemos iniciar sesión con el usuario <code>odoo</code> (es necesario que pueda iniciar sesión en Linux) y ejecutar:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>odoo<span class="w"> </span>--config<span class="w"> </span>/etc/odoo/odoo.conf
</span></code></pre></div>
<p>De esta manera, los mensajes del servidor aparecen en tiempo real en la consola.</p>
<p>Si además queremos actualizar un módulo al arrancar, podemos especificar la base de datos y el módulo a actualizar:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>odoo<span class="w"> </span>--config<span class="w"> </span>/etc/odoo/odoo.conf<span class="w"> </span>-u<span class="w"> </span>modulo<span class="w"> </span>-d<span class="w"> </span>empresa
</span></code></pre></div>
<p>Puede que nuestro usuario <code>odoo</code> tenga una configuración personalizada. En ese caso, habría que hacer, por ejemplo:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>odoo<span class="w"> </span>--config<span class="w"> </span>/var/lib/odoo/.odoorc<span class="w"> </span>-d<span class="w"> </span>empresa<span class="w"> </span>-u<span class="w"> </span>modulo
</span></code></pre></div>
<p>De hecho, una vez hecho el <code>--save</code>, cada vez que ejecutamos el comando <strong>odoo</strong>, busca el archivo <code>.odoorc</code> en el directorio personal del usuario. Por tanto, solo hay que hacer:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>odoo<span class="w"> </span>-d<span class="w"> </span>empresa<span class="w"> </span>-u<span class="w"> </span>modulo
</span></code></pre></div>
<p>Además, podemos modificar el nivel de log con la opción <code>--log-level</code>, por ejemplo: <code>--log-level=debug</code>.</p>
<blockquote>
<p><a href="https://asciinema.org/a/122901">Asciinema con todos los pasos para depurar.</a></p>
</blockquote>
<p>Para saber más, puedes consultar la ayuda:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>odoo<span class="w"> </span>--help
</span></code></pre></div>
<p>O la documentación oficial:
<a href="https://www.odoo.com/documentation/12.0/reference/cmdline.html">https://www.odoo.com/documentation/12.0/reference/cmdline.html</a></p>
<h2 id="mejorar-la-salida-de-log">Mejorar la salida de Log</h2>
<p>Para añadir salida de log en nuestros métodos y facilitar la depuración, se puede utilizar la API de Odoo:</p>
<p>Al principio del archivo <code>.py</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></code></pre></div>
<p>Dentro de las funciones:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Usa _logger.debug para depuración, solo para este propósito.&quot;</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Usa _logger.info para mensajes informativos. Se utiliza para notificar algo importante.&quot;</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Usa _logger.warning para problemas menores, que no harán fallar tu módulo.&quot;</span><span class="p">)</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Usa _logger.error para informar de una operación fallida.&quot;</span><span class="p">)</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">_logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Usa _logger.critical para mensajes críticos: si esto aparece, el módulo dejará de funcionar.&quot;</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c1"># ¿Quieres incluir datos de tu campo? Pásalos en el contexto, obténlos del pool o del diccionario.</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">_logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;El nombre &#39;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&#39; no es válido para nosotros.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="opciones-de-log">Opciones de log</h2>
<p>Por defecto, Odoo envía su log a un archivo en <strong>/var/log/odoo/</strong>, pero se puede redirigir a otro archivo con <strong>--log-file=LOGFILE</strong>.</p>
<p>Si queremos más detalle en determinadas acciones de Odoo, podemos añadir al comando las siguientes opciones:</p>
<ul>
<li><strong>--log-request</strong>: Muestra las peticiones <strong>RPC</strong> (remote procedure call) hechas por http desde el cliente.</li>
<li><strong>--log-response</strong>: Muestra el contenido de la respuesta que da el servidor a las peticiones anteriores. Muy útil para saber qué está enviando y cómo lo interpreta el cliente.</li>
<li><strong>--log-web</strong>: Da más detalles de todas las peticiones GET o POST que se hacen a la web.</li>
<li><strong>--log-sql</strong>: Muestra el SQL que lanza al servidor PostgreSQL. Esta opción ayuda a entender cómo funciona el ORM.</li>
<li><strong>--log-level=LOG_LEVEL</strong></li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;debug_rpc&#39;</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="s1">&#39;debug_sql&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="s1">&#39;debug_rpc_answer&#39;</span><span class="p">,</span> <span class="s1">&#39;notset&#39;</span><span class="p">]</span>
</span></code></pre></div>
<h2 id="modo-debug">Modo debug</h2>
<p>Odoo permite entrar en modo debug con <strong>--debug</strong>.</p>
<p>También se puede importar la biblioteca <strong>pdb</strong> y colocar un <em>trace</em> en el código que nos interesa:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span> <span class="nn">pdb</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">...</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</span></code></pre></div>
<p>Una vez dentro, se pueden utilizar los comandos de pdb:<br />
<a href="https://docs.python.org/3/library/pdb.html">https://docs.python.org/3/library/pdb.html</a></p>
<h2 id="poner-en-produccion-en-ubuntu">Poner en producción en Ubuntu</h2>
<p><a href="https://docs.docker.com/engine/install/linux-postinstall/#configure-docker-to-start-on-boot-with-systemd">https://www.odoo.com/documentation/17.0/administration/install/deploy.html?highlight=workers</a></p>
<h2 id="odoo-por-https">Odoo por HTTPS</h2>
<p>El servidor Odoo, por defecto, ofrece su web en el puerto 8069 y en HTTP, es decir, sin capa de seguridad SSL.</p>
<p>Para dotarlo de esa seguridad, necesitamos utilizar un servidor web que actúe como proxy y proporcione la conectividad por HTTPS.</p>
<p>Situación inicial:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a> ------------               -----------
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>|            |        8069|            |
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>|  Cliente   |&lt;----------&gt;|  Servidor  |
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>|            |            |   Odoo     |
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a> ------------              ------------
</span></code></pre></div>
<p>Situación que buscamos:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a> ------------              -------------------
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>|            |        443 |                   |
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>|  Cliente   |&lt;----------&gt;|   Nginx &lt;---┐     |
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>|            |            |              |    |
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a> ------------             |              |8069|
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>                          |              v    |
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>                          |            ------ |
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>                          |            |Odoo| |
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>                          |            ------ |
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>                           -------------------
</span></code></pre></div>
<p>Todos los servicios que utilizan SSL necesitan un certificado. En una situación ideal, disponemos de un certificado firmado por una entidad certificadora. Si no es así, debemos crear uno autosignado.</p>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-16-04">Tutorial para crear el certificado</a></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="w">    </span><span class="c1"># openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/odoo-selfsigned.key -out /etc/ssl/certs/odoo-selfsigned.crt</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span>Generating<span class="w"> </span>a<span class="w"> </span><span class="m">2048</span><span class="w"> </span>bit<span class="w"> </span>RSA<span class="w"> </span>private<span class="w"> </span>key
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span>...........................................................................................................+++
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span>...........................................................................................+++
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">    </span>writing<span class="w"> </span>new<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/etc/ssl/private/odoo-selfsigned.key&#39;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">    </span>-----
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">    </span>You<span class="w"> </span>are<span class="w"> </span>about<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>asked<span class="w"> </span>to<span class="w"> </span>enter<span class="w"> </span>information<span class="w"> </span>that<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>incorporated
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span>into<span class="w"> </span>your<span class="w"> </span>certificate<span class="w"> </span>request.
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span>What<span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>about<span class="w"> </span>to<span class="w"> </span>enter<span class="w"> </span>is<span class="w"> </span>what<span class="w"> </span>is<span class="w"> </span>called<span class="w"> </span>a<span class="w"> </span>Distinguished<span class="w"> </span>Name<span class="w"> </span>or<span class="w"> </span>a<span class="w"> </span>DN.
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">    </span>There<span class="w"> </span>are<span class="w"> </span>quite<span class="w"> </span>a<span class="w"> </span>few<span class="w"> </span>fields<span class="w"> </span>but<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>leave<span class="w"> </span>some<span class="w"> </span>blank
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">    </span>For<span class="w"> </span>some<span class="w"> </span>fields<span class="w"> </span>there<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>a<span class="w"> </span>default<span class="w"> </span>value,
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">    </span>If<span class="w"> </span>you<span class="w"> </span>enter<span class="w"> </span><span class="s1">&#39;.&#39;</span>,<span class="w"> </span>the<span class="w"> </span>field<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>left<span class="w"> </span>blank.
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">    </span>-----
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">    </span>Country<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="w"> </span>letter<span class="w"> </span>code<span class="o">)</span><span class="w"> </span><span class="o">[</span>AU<span class="o">]</span>:ES
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">    </span>State<span class="w"> </span>or<span class="w"> </span>Province<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span>full<span class="w"> </span>name<span class="o">)</span><span class="w"> </span><span class="o">[</span>Some-State<span class="o">]</span>:Valencia
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">    </span>Locality<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span>eg,<span class="w"> </span>city<span class="o">)</span><span class="w"> </span><span class="o">[]</span>:<span class="w"> </span>Xàtiva
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="w">    </span>Organization<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span>eg,<span class="w"> </span>company<span class="o">)</span><span class="w"> </span><span class="o">[</span>Internet<span class="w"> </span>Widgits<span class="w"> </span>Pty<span class="w"> </span>Ltd<span class="o">]</span>:
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">    </span>Organizational<span class="w"> </span>Unit<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span>eg,<span class="w"> </span>section<span class="o">)</span><span class="w"> </span><span class="o">[]</span>:
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">    </span>Common<span class="w"> </span>Name<span class="w"> </span><span class="o">(</span>e.g.<span class="w"> </span>server<span class="w"> </span>FQDN<span class="w"> </span>or<span class="w"> </span>YOUR<span class="w"> </span>name<span class="o">)</span><span class="w"> </span><span class="o">[]</span>:<span class="w"> </span>nom<span class="w"> </span>o<span class="w"> </span>domini
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="w">    </span>Email<span class="w"> </span>Address<span class="w"> </span><span class="o">[]</span>:<span class="w"> </span>correu@servidor.com
</span></code></pre></div>
<p>A continuación se debe configurar el https en Nginx para hacer el proxy en Odoo. <a href="https://www.odoo.com/documentation/9.0/setup/deploy.html#https">manual oficial</a></p>
<p>En /etc/odoo.conf:</p>
<p><div class="language-js highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nx">proxy_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">True</span><span class="w"> </span>
</span></code></pre></div>
En /etc/nginx/sites-enabled/odoo.conf:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">    </span><span class="c1">#odoo server</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span>upstream<span class="w"> </span>odoo<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">     </span>server<span class="w"> </span><span class="m">127</span>.0.0.1:8069<span class="p">;</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span>upstream<span class="w"> </span>odoochat<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">     </span>server<span class="w"> </span><span class="m">127</span>.0.0.1:8072<span class="p">;</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="c1"># S&#39;han definit els upstream a localhost i als port determinats</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">    </span><span class="c1"># http -&gt; https (totes les peticions per HTTP se reformulen a HTTPS)</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">    </span>server<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">       </span>listen<span class="w"> </span><span class="m">80</span><span class="p">;</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">       </span>server_name<span class="w"> </span>_<span class="p">;</span><span class="w">                            </span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">       </span><span class="c1"># Si tinguerem nom de domini el ficariem, en altre cas: _</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">       </span>rewrite<span class="w"> </span>^<span class="o">(</span>.*<span class="o">)</span><span class="w"> </span>https://<span class="nv">$host$1</span><span class="w"> </span>permanent<span class="p">;</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">    </span>server<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">     </span>listen<span class="w"> </span><span class="m">443</span><span class="p">;</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">     </span>server_name<span class="w"> </span>_<span class="p">;</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">     </span><span class="c1"># La _ perquè en l&#39;exemple no tenim domini, com dalt</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">     </span>proxy_read_timeout<span class="w"> </span>720s<span class="p">;</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">     </span>proxy_connect_timeout<span class="w"> </span>720s<span class="p">;</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">     </span>proxy_send_timeout<span class="w"> </span>720s<span class="p">;</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">     </span><span class="c1"># Add Headers for odoo proxy mode</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">     </span>proxy_set_header<span class="w"> </span>X-Forwarded-Host<span class="w"> </span><span class="nv">$host</span><span class="p">;</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">     </span>proxy_set_header<span class="w"> </span>X-Forwarded-For<span class="w"> </span><span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">     </span>proxy_set_header<span class="w"> </span>X-Forwarded-Proto<span class="w"> </span><span class="nv">$scheme</span><span class="p">;</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">     </span>proxy_set_header<span class="w"> </span>X-Real-IP<span class="w"> </span><span class="nv">$remote_addr</span><span class="p">;</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="w">     </span><span class="c1"># SSL parameters</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">     </span>ssl<span class="w"> </span>on<span class="p">;</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">     </span>ssl_certificate<span class="w"> </span>/etc/ssl/certs/odoo-selfsigned.crt<span class="p">;</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">     </span>ssl_certificate_key<span class="w"> </span>/etc/ssl/private/odoo-selfsigned.key<span class="w"> </span><span class="p">;</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="w">     </span><span class="c1"># IMPORTANT: ficar bé les rutes dels certificats</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="w">     </span>ssl_session_timeout<span class="w"> </span>30m<span class="p">;</span>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">     </span>ssl_protocols<span class="w"> </span>TLSv1<span class="w"> </span>TLSv1.1<span class="w"> </span>TLSv1.2<span class="p">;</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="w">     </span>ssl_ciphers<span class="w"> </span><span class="s1">&#39;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA&#39;</span><span class="p">;</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="w">     </span>ssl_prefer_server_ciphers<span class="w"> </span>on<span class="p">;</span>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>
</span><span id="__span-23-42"><a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a><span class="w">     </span><span class="c1"># log</span>
</span><span id="__span-23-43"><a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a><span class="w">     </span>access_log<span class="w"> </span>/var/log/nginx/odoo.access.log<span class="p">;</span>
</span><span id="__span-23-44"><a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a><span class="w">     </span>error_log<span class="w"> </span>/var/log/nginx/odoo.error.log<span class="p">;</span>
</span><span id="__span-23-45"><a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a>
</span><span id="__span-23-46"><a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a><span class="w">     </span><span class="c1"># Redirect requests to odoo backend server</span>
</span><span id="__span-23-47"><a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="w">     </span>location<span class="w"> </span>/<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-48"><a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="w">       </span>proxy_redirect<span class="w"> </span>off<span class="p">;</span>
</span><span id="__span-23-49"><a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a><span class="w">       </span>proxy_pass<span class="w"> </span>http://odoo<span class="p">;</span>
</span><span id="__span-23-50"><a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a><span class="w">     </span><span class="o">}</span>
</span><span id="__span-23-51"><a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a><span class="w">     </span>location<span class="w"> </span>/longpolling<span class="w"> </span><span class="o">{</span>
</span><span id="__span-23-52"><a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a><span class="w">         </span>proxy_pass<span class="w"> </span>http://odoochat<span class="p">;</span>
</span><span id="__span-23-53"><a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a><span class="w">     </span><span class="o">}</span>
</span><span id="__span-23-54"><a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a>
</span><span id="__span-23-55"><a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a><span class="w">     </span><span class="c1"># common gzip</span>
</span><span id="__span-23-56"><a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a><span class="w">     </span>gzip_types<span class="w"> </span>text/css<span class="w"> </span>text/less<span class="w"> </span>text/plain<span class="w"> </span>text/xml<span class="w"> </span>application/xml<span class="w"> </span>application/json<span class="w"> </span>application/javascript<span class="p">;</span>
</span><span id="__span-23-57"><a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a><span class="w">     </span>gzip<span class="w"> </span>on<span class="p">;</span>
</span><span id="__span-23-58"><a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a><span class="w">    </span><span class="o">}</span>
</span></code></pre></div>
<p>También es necesario borrar el <strong>default</strong> de sites-enabled de nginx o modificarlo para que no afecte al puerto 80 de Odoo.</p>
<p>Ahora se reinician tanto Odoo como nginx.</p>
<h1 id="seguridad-en-odoo">Seguridad en Odoo</h1>
<p>Cuando hablamos de seguridad en Odoo nos referimos tanto a cuestiones generales que afectan a cualquier aplicación web como a aspectos específicos de Odoo. En general, cualquier aplicación web debe cumplir unos mínimos de seguridad, como ofrecer el servicio solo por HTTPS, controlar los puertos, evitar ataques DDOS, utilizar contraseñas seguras, etc.</p>
<p>En cuanto al HTTPS, en los apartados correspondientes se explica cómo configurarlo, aunque lo ideal sería contratar un certificado válido. La seguridad y alta disponibilidad del servidor es un tema complejo que excede el alcance de este módulo y puede ser tarea del ciclo de ASIX. Sin embargo, sí podemos realizar acciones específicas en Odoo para evitar problemas o recuperarnos rápidamente de ellos.</p>
<h2 id="persistencia-de-los-datos">Persistencia de los datos</h2>
<p>Una empresa no puede permitirse perder datos. Existen múltiples formas de evitar la pérdida de datos en Odoo. Si tenemos una instalación on-premise, debemos controlar todos los factores, tanto físicos como lógicos. Esto implica varias tareas imprescindibles:</p>
<h3 id="copias-de-seguridad">Copias de seguridad</h3>
<p>Odoo, en su interfaz gráfica, permite exportar tablas y realizar copias de seguridad manuales de tablas individuales. Esto, por supuesto, solo es recomendable para exportaciones o importaciones puntuales.</p>
<p>En la interfaz gráfica también se puede acceder al gestor de bases de datos y exportar o importar el backup. Sería recomendable hacerlo periódicamente. Si queremos que sea automático, se puede programar externamente un servicio que, cada cierto tiempo, se conecte de forma remota por XML-RPC:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1"># Datos de conexión</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="n">odoo_host</span> <span class="o">=</span> <span class="s1">&#39;https://tuservidorodoo.com&#39;</span>  <span class="c1"># o http://localhost:8069 si es local</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;tu_basededatos&#39;</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="n">admin_password</span> <span class="o">=</span> <span class="s1">&#39;tu_contraseña_admin&#39;</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="c1"># URL para hacer backup</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">odoo_host</span><span class="si">}</span><span class="s1">/web/database/backup&#39;</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c1"># Datos para la solicitud POST</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>    <span class="s1">&#39;master_pwd&#39;</span><span class="p">:</span> <span class="n">admin_password</span><span class="p">,</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">database</span><span class="p">,</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>    <span class="s1">&#39;backup_format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span>  <span class="c1"># o &#39;dump&#39;</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="p">}</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="c1"># Realizar la solicitud POST</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="c1"># Verificar la respuesta y guardar el archivo si es válida</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">database</span><span class="si">}</span><span class="s2">_backup.zip&quot;</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Backup guardado como </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error al hacer backup: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>También podemos hacerlo a nivel de la línea de comandos de la base de datos:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>pg_dump<span class="w"> </span>db_name
</span></code></pre></div>
<p>La copia de seguridad de la base de datos no incluye los archivos y fotos. Será necesario copiar el directorio <code>filestore</code> si realizamos la copia a nivel de base de datos.</p>
<p>A un nivel más bajo, se puede hacer una copia de seguridad del sistema de archivos o incluso de las particiones.</p>
<p>Es importante destacar que dicha copia de seguridad no debe almacenarse en el mismo disco duro que la base de datos original ni en la misma ubicación física.</p>
<h2 id="alta-disponibilidad">Alta disponibilidad</h2>
<p>Un sistema empresarial debe estar alojado en un servidor seguro a nivel físico. Esto implica el uso de SAIs y RAIDs o sistemas similares. Si estamos utilizando un VPS en la nube, normalmente no tendremos que preocuparnos de esto. En caso contrario, necesitaremos un CPD, aunque sea sencillo, con seguridad física, sistemas de alimentación ininterrumpida y discos redundantes, además de sistemas de copias de seguridad remotas. El sistema debería poder recuperarse de un fallo sin interrumpir el servicio.</p>
<h2 id="usuarios-y-permisos">Usuarios y permisos</h2>
<p>Odoo cuenta con un sistema complejo de usuarios, grupos, roles y permisos. Un administrador de Odoo debe gestionar de forma precisa estos permisos. Además, debemos distinguir los diferentes tipos de usuarios que hay que gestionar, de mayor a menor nivel de privilegio:</p>
<ul>
<li>Root del sistema operativo: Usuario con control total sobre el sistema operativo; debería ser un administrador de sistemas.</li>
<li>Administrador de PostgreSQL: Tiene control total sobre los datos de toda la empresa y posiblemente de varias empresas. Si PostgreSQL se utiliza para otros fines además de Odoo, también tiene poder sobre ellos.</li>
<li>Administrador de bases de datos de Odoo: Su contraseña está en <code>odoo.conf</code> y puede crear, borrar y hacer copias de todas las bases de datos. Accede normalmente vía web. Es posible que los programadores no necesiten este nivel de acceso.</li>
<li>Administrador técnico de una base de datos: Puede administrar módulos y cambiar la interfaz. Los programadores suelen necesitar este nivel de permisos.</li>
<li>Administrador de la empresa: Puede administrar todo lo relativo al negocio, pero no puede instalar módulos ni programar. Normalmente son los propietarios o responsables de la empresa. No es recomendable que una persona sin experiencia en programación tenga más permisos.</li>
<li>Usuarios normales: Vendedores, administrativos, etc. Pueden acceder a ciertas partes del backend. Sus permisos dependen del grupo o rol al que pertenezcan.</li>
<li>Clientes y proveedores: Normalmente tienen acceso a la página web, que puede estar hecha con Odoo. También pueden tener acceso a una API desarrollada por nosotros si queremos automatizar las relaciones comerciales con ellos.</li>
</ul>
<h1 id="creacion-de-una-base-de-datos">Creación de una base de datos</h1>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>En general no cal fer aquest pas i és recomanable fer la base de dades per la interfície web.</p>
</div>
<p>En el usuario de odoo, creamos una base de datos y le aplicamos el esquema de datos de Odoo:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>createdb<span class="w"> </span>--encoding<span class="o">=</span>UTF-8<span class="w"> </span>--template<span class="o">=</span>template0<span class="w"> </span>testdb
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>odoo<span class="w"> </span>-d<span class="w"> </span>testdb
</span></code></pre></div>
<p>Esto crea una base de datos con los datos de prueba para empezar a trabajar.</p>
<p>Por defecto, el usuario será admin con contraseña admin.</p>
<p><a href="https://gist.github.com/Kartones/dd3ff5ec5ea238d4c546">Comandos básicos de postgreSQL</a></p>
<h1 id="errores-documentados">Errores documentados</h1>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
</div>
<p><strong>Importante</strong> Antes de ejecutar estos comandos, consulta el final del archivo de log, generalmente en /var/log/odoo/odoo-server.log</p>
<h2 id="error-con-el-rol-odoo">Error con el rol Odoo</h2>
<p>Si aparece un error similar a:</p>
<p><code>OperationalError: FATAL:  no existe el rol «odoo»</code><br />
<code>OperationalError: FATAL:  role "odoo" does not exist</code></p>
<p>Hay que ejecutar el comando:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>su<span class="w"> </span>-<span class="w"> </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;createuser -s odoo&quot;</span>
</span></code></pre></div>
<p>Esto crea el usuario odoo con permiso de superusuario (-s).</p>
<h2 id="error-con-utf-8">Error con UTF-8</h2>
<p>Muchas veces, al instalar, no se configura el <em>template0</em> de la base de datos en utf-8.<br />
<a href="http://www.postgresql.org/docs/9.3/static/manage-ag-templatedbs.html">1</a></p>
<p>Se soluciona borrando y volviendo a crear la base de datos template1 utilizando la codificación UTF8.<br />
<a href="https://gist.github.com/ffmike/877447">2</a></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># su postgres</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>psql
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="nv">postgres</span><span class="o">=</span><span class="c1"># update pg_database set datallowconn = TRUE where datname = &#39;template0&#39;;</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="nv">postgres</span><span class="o">=</span><span class="c1"># \c template0</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="nv">template0</span><span class="o">=</span><span class="c1"># update pg_database set datistemplate = FALSE where datname = &#39;template1&#39;;</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="nv">template0</span><span class="o">=</span><span class="c1"># drop database template1;</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="nv">template0</span><span class="o">=</span><span class="c1"># create database template1 with template = template0 encoding = &#39;UTF8&#39;;</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="nv">template0</span><span class="o">=</span><span class="c1"># update pg_database set datistemplate = TRUE where datname = &#39;template1&#39;;</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="nv">template0</span><span class="o">=</span><span class="c1"># \c template1</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="nv">template1</span><span class="o">=</span><span class="c1"># update pg_database set datallowconn = FALSE where datname = &#39;template0&#39;;</span>
</span></code></pre></div>
<p>Puede que no se cree el clúster de postgresql. Primero hay que reconfigurar los locales y después:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>pg_createcluster<span class="w"> </span><span class="m">9</span>.4<span class="w"> </span>main<span class="w"> </span>--start
</span></code></pre></div>
<h2 id="recuperar-la-contrasena-del-administrador">Recuperar la contraseña del administrador</h2>
<p><strong>Del administrador de una base de datos:</strong> Dentro de la base de datos:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">update</span><span class="w"> </span><span class="n">res_users</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">login</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>Del administrador de Odoo</strong></p>
<p>Si no puedes administrar o crear nuevas bases de datos, hay que modificar la línea <strong>admin_passwd</strong> de /etc/odoo/odoo.conf o .odoorc, dependiendo de qué archivo de configuración estés usando.</p>
<h2 id="problemas-en-los-repositorios-oficiales-de-ubuntu">Problemas en los repositorios oficiales de ubuntu</h2>
<p>En el caso del IES, los repositorios oficiales no funcionan bien por alguna interferencia con los de Lliurex. Hay que cambiarlos, por ejemplo, por los de Caliu. Una manera es entrar en <strong>vim</strong> y ejecutar este comando:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>:%s_http://archive.ubuntu.com/ubuntu_http://ftp.udc.es/ubuntu/_
</span></code></pre></div>
<p>(Usamos _ en lugar de / en la sustitución porque la / ya está en las URL.)</p>
<h2 id="no-conecta-con-postgresql">No conecta con PostgreSQL</h2>
<p>Puede ser porque el servicio no está en funcionamiento.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>service<span class="w"> </span>postgresql<span class="w"> </span><span class="o">[</span>restart,start,stop,status<span class="o">]</span>
</span></code></pre></div>
<p>En caso de que falle, podemos ver el log:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>cat<span class="w"> </span>/var/log/postgresql/<span class="o">(</span>version<span class="o">)</span>...
</span></code></pre></div>
<p>A veces la base de datos queda corrupta. Se puede intentar recuperar con:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>su<span class="w"> </span>-<span class="w"> </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;/usr/lib/postgresql/12/bin/pg_resetwal -f /var/lib/postgresql/12/main&#39;</span>
</span></code></pre></div>
<p>Si se han perdido datos, no son muy importantes o tenemos copia de seguridad, tal vez hay que eliminar la base de datos de la empresa que no funciona:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>postgres$<span class="w"> </span>psql
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>psql&gt;<span class="w"> </span>drop<span class="w"> </span>database<span class="w"> </span>&lt;nombre_base_de_datos&gt;<span class="p">;</span>
</span></code></pre></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.instant", "navigation.instant.progress", "toc.follow", "navigation.top", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>